{"version":3,"file":"root.js","sources":["../../../../xpack/scripts/root.entry.ts"],"sourcesContent":["const BORDER_SIZE = 20;\nconst MIN_FRAME_SIZE = 350;\nconst MSG_IFRAME_SIZE = 'MSG_IFRAME_SIZE';\n\nlet orgWidth: number;\nlet pos: number;\n\nconst wrapper = document.getElementById('root-iframe-wrapper');\nconst frame = document.getElementById('root-iframe');\nconst resizer = document.getElementById('root-iframe-resizer');\n\nlet iframeSize = sessionStorage.getItem(MSG_IFRAME_SIZE);\n\nconst setIFrameWidth = (width?: number) => {\n  if (!wrapper) {\n    return;\n  }\n\n  if (width) {\n    wrapper.style.maxWidth = `min(100%, ${width}px)`;\n  } else {\n    wrapper.style.removeProperty('max-width');\n  }\n};\n\nconst resize = (e: globalThis.MouseEvent) => {\n  e.stopPropagation();\n  e.preventDefault();\n  const dx = (e.x - pos) * 2;\n\n  const size = Math.max(MIN_FRAME_SIZE, orgWidth + dx);\n\n  setIFrameWidth(size);\n  iframeSize = size + '';\n\n  return false;\n};\n\nconst mouseUp = () => {\n  if (!wrapper || !frame) {\n    return;\n  }\n\n  wrapper.style.removeProperty('transition');\n  frame.style.removeProperty('pointer-events');\n  iframeSize && sessionStorage.setItem(MSG_IFRAME_SIZE, iframeSize);\n\n  document.removeEventListener('mousemove', resize, false);\n};\n\nconst handleResizerMouseDown = (e: MouseEvent) => {\n  if (!wrapper || !frame || e.offsetX >= BORDER_SIZE) {\n    return;\n  }\n\n  wrapper.style.transition = 'none';\n  frame.style.pointerEvents = 'none';\n  pos = e.x;\n  orgWidth = parseInt(getComputedStyle(wrapper, '').width);\n  document.addEventListener('mousemove', resize, false);\n  document.addEventListener('mouseup', mouseUp, false);\n};\n\nconst initTopPanel = () => {\n  const isTopPanel = localStorage.getItem('MSG_IS_TOP_PANEL') === 'true';\n  const rootEl = document.querySelector('.xpack-t-root');\n\n  if (!rootEl) {\n    return;\n  }\n  if (isTopPanel) {\n    rootEl.classList.add('top-panel');\n  }\n};\n\nconst handleStoreModified = (event: StorageEvent) => {\n  switch (event.key) {\n    case 'MSG_IS_TOP_PANEL': {\n      const isTopPanel = event.newValue === 'true';\n      const rootEl = document.querySelector('.xpack-t-root');\n\n      if (!rootEl) {\n        return;\n      }\n\n      if (isTopPanel) {\n        rootEl.classList.add('top-panel');\n      } else {\n        rootEl.classList.remove('top-panel');\n      }\n      break;\n    }\n  }\n};\n\nconst addStoreEvent = () => {\n  window.addEventListener('storage', handleStoreModified);\n};\n\nconst setup = () => {\n  if (!resizer || !frame) {\n    return;\n  }\n\n  resizer.onmousedown = handleResizerMouseDown;\n  setIFrameWidth(iframeSize ? parseInt(iframeSize) : undefined);\n\n  const getIFrameActualWidth = () => {\n    const el = document.getElementById('root-actual-iframe-width');\n\n    if (el) {\n      el.textContent = Math.ceil(parseInt(getComputedStyle(frame).width)) + 'px';\n    }\n  };\n\n  frame.onload = getIFrameActualWidth;\n\n  if ('ResizeObserver' in window) {\n    // create an Observer instance\n    const resizeObserver = new ResizeObserver(getIFrameActualWidth);\n\n    // start observing a DOM node\n    resizeObserver.observe(frame);\n  }\n  initTopPanel();\n  addStoreEvent();\n\n  if (wrapper) {\n    window.onload = () => wrapper.classList.add('initialized');\n  }\n};\n\nsetup();\n\nexport {};\n"],"names":["MSG_IFRAME_SIZE","orgWidth","pos","wrapper","frame","resizer","iframeSize","setIFrameWidth","width","resize","dx","size","mouseUp","handleResizerMouseDown","initTopPanel","isTopPanel","rootEl","handleStoreModified","event","addStoreEvent","setup","getIFrameActualWidth","el"],"mappings":"AAEA,MAAMA,EAAkB,kBAExB,IAAIC,EACAC,EAEJ,MAAMC,EAAU,SAAS,eAAe,qBAAqB,EACvDC,EAAQ,SAAS,eAAe,aAAa,EAC7CC,EAAU,SAAS,eAAe,qBAAqB,EAE7D,IAAIC,EAAa,eAAe,QAAQN,CAAe,EAEvD,MAAMO,EAAkBC,GAAmB,CACpCL,IAIDK,EACFL,EAAQ,MAAM,SAAW,aAAaK,CAAK,MAE3CL,EAAQ,MAAM,eAAe,WAAW,EAE5C,EAEMM,EAAU,GAA6B,CAC3C,EAAE,gBAAA,EACF,EAAE,eAAA,EACF,MAAMC,GAAM,EAAE,EAAIR,GAAO,EAEnBS,EAAO,KAAK,IAAI,IAAgBV,EAAWS,CAAE,EAEnD,OAAAH,EAAeI,CAAI,EACnBL,EAAaK,EAAO,GAEb,EACT,EAEMC,EAAU,IAAM,CAChB,CAACT,GAAW,CAACC,IAIjBD,EAAQ,MAAM,eAAe,YAAY,EACzCC,EAAM,MAAM,eAAe,gBAAgB,EAC3CE,GAAc,eAAe,QAAQN,EAAiBM,CAAU,EAEhE,SAAS,oBAAoB,YAAaG,EAAQ,EAAK,EACzD,EAEMI,EAA0B,GAAkB,CAC5C,CAACV,GAAW,CAACC,GAAS,EAAE,SAAW,KAIvCD,EAAQ,MAAM,WAAa,OAC3BC,EAAM,MAAM,cAAgB,OAC5BF,EAAM,EAAE,EACRD,EAAW,SAAS,iBAAiBE,EAAS,EAAE,EAAE,KAAK,EACvD,SAAS,iBAAiB,YAAaM,EAAQ,EAAK,EACpD,SAAS,iBAAiB,UAAWG,EAAS,EAAK,EACrD,EAEME,EAAe,IAAM,CACzB,MAAMC,EAAa,aAAa,QAAQ,kBAAkB,IAAM,OAC1DC,EAAS,SAAS,cAAc,eAAe,EAEhDA,GAGDD,GACFC,EAAO,UAAU,IAAI,WAAW,CAEpC,EAEMC,EAAuBC,GAAwB,CACnD,OAAQA,EAAM,IAAA,CACZ,IAAK,mBAAoB,CACvB,MAAMH,EAAaG,EAAM,WAAa,OAChCF,EAAS,SAAS,cAAc,eAAe,EAErD,GAAI,CAACA,EACH,OAGED,EACFC,EAAO,UAAU,IAAI,WAAW,EAEhCA,EAAO,UAAU,OAAO,WAAW,EAErC,KACF,CAAA,CAEJ,EAEMG,EAAgB,IAAM,CAC1B,OAAO,iBAAiB,UAAWF,CAAmB,CACxD,EAEMG,EAAQ,IAAM,CAClB,GAAI,CAACf,GAAW,CAACD,EACf,OAGFC,EAAQ,YAAcQ,EACtBN,EAAeD,EAAa,SAASA,CAAU,EAAI,MAAS,EAE5D,MAAMe,EAAuB,IAAM,CACjC,MAAMC,EAAK,SAAS,eAAe,0BAA0B,EAEzDA,IACFA,EAAG,YAAc,KAAK,KAAK,SAAS,iBAAiBlB,CAAK,EAAE,KAAK,CAAC,EAAI,KAE1E,EAEAA,EAAM,OAASiB,EAEX,mBAAoB,QAEC,IAAI,eAAeA,CAAoB,EAG/C,QAAQjB,CAAK,EAE9BU,EAAA,EACAK,EAAA,EAEIhB,IACF,OAAO,OAAS,IAAMA,EAAQ,UAAU,IAAI,aAAa,EAE7D,EAEAiB,EAAA"}